<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Panel de Autoridad - Plataforma de Denuncias</title>
  <link href="assets/css/base.css" rel="stylesheet">
  <link href="assets/css/components.css" rel="stylesheet">
  <link href="assets/css/main.css" rel="stylesheet">
  <style>
    body { background-color: #f0f2f5; padding-top: 80px; }
    main { padding: 20px; }
    .dashboard-container { max-width: 1200px; margin: auto; }
    .card { background-color: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
    h2, h3 { color: #333; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 12px; border: 1px solid #ddd; text-align: left; }
    th { background-color: #f8f9fa; }
    .status { font-weight: bold; }
    .status-recibido { color: #ffc107; }
    .status-en-proceso { color: #0dcaf0; }
    .status-resuelta { color: #198754; }
    select { padding: 5px; border-radius: 4px; }
  </style>
</head>
<body>

  <header id="header" class="header fixed-top d-flex align-items-center">
    <div class="container d-flex align-items-center justify-content-between">
      <a href="index.html" class="logo d-flex align-items-center me-auto me-xl-0">
        <img src="assets/img/logos/logo.png" alt="Logo">
        <h1>PLATAFORMA DE DENUNCIAS</h1>
      </a>
      <nav id="navmenu" class="navmenu">
        <ul>
          <li><a href="index.html#inicio" class="active">Inicio</a></li>
          <li><a href="index.html#nosotros">Nosotros</a></li>
          <li><a href="index.html#tramites">Denuncias</a></li>                  
          <li><a href="index.html#contacto">Contacto</a></li>
          <li><a href="#" id="logout">Cerrar Sesión</a></li>          
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <div class="dashboard-container">
      <div class="card">
        <h2>Panel de Autoridad</h2>
        <p>Gestión de denuncias ciudadanas.</p>
      </div>

      <div class="card">
        <h3>Listado de Denuncias</h3>
        <table id="tablaDenuncias">
          <thead>
            <tr>
              <th>ID</th>
              <th>Tipo</th>
              <th>Ciudadano</th>
              <th>Fecha</th>
              <th>Estado</th>
              <th>Acción</th>
            </tr>
          </thead>
          <tbody>
            <!-- Filas se cargarán dinámicamente -->
          </tbody>
        </table>
      </div>
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const token = localStorage.getItem('token');
      const rol = localStorage.getItem('rol');
      if (!token || rol !== 'autoridad') {
        window.location.href = 'login.html';
        return;
      }

      // Logout
      document.getElementById('logout').addEventListener('click', () => {
        localStorage.removeItem('token');
        localStorage.removeItem('rol');
        window.location.href = 'index.html';
      });

      // Cargar denuncias (simulado)
      const tbody = document.querySelector('#tablaDenuncias tbody');
      const denuncias = [
        { id: 1, tipo: 'Bache en la vía', ciudadano: 'Juan Pérez', fecha: '2025-09-01', estado: 'Recibido' },
        { id: 2, tipo: 'Falta de alumbrado', ciudadano: 'Ana Gómez', fecha: '2025-08-25', estado: 'Resuelta' },
        { id: 3, tipo: 'Acumulación de basura', ciudadano: 'Carlos Ruiz', fecha: '2025-09-03', estado: 'En Proceso' },
      ];

      if (denuncias.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6">No hay denuncias para mostrar.</td></tr>';
      } else {
        denuncias.forEach(d => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${d.id}</td>
            <td>${d.tipo}</td>
            <td>${d.ciudadano}</td>
            <td>${d.fecha}</td>
            <td><span class="status status-${d.estado.toLowerCase().replace(' ', '-')}">${d.estado}</span></td>
            <td>
              <select data-id="${d.id}">
                <option value="Recibido" ${d.estado === 'Recibido' ? 'selected' : ''}>Recibido</option>
                <option value="En Proceso" ${d.estado === 'En Proceso' ? 'selected' : ''}>En Proceso</option>
                <option value="Resuelta" ${d.estado === 'Resuelta' ? 'selected' : ''}>Resuelta</option>
              </select>
            </td>
          `;
          tbody.appendChild(row);
        });
      }

      // Cambiar estado (simulado)
      tbody.addEventListener('change', function(e) {
        if (e.target.tagName === 'SELECT') {
          const id = e.target.dataset.id;
          const nuevoEstado = e.target.value;
          alert(`(Simulación) Cambiando estado de la denuncia ID ${id} a ${nuevoEstado}.`);
        }
      });

    });
  </script>
</body>
</html>
